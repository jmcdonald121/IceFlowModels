// JOB ,
// REGION=512K
// EXEC VSF2CLG
//FORT.SYSIN  DD  *
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C     ***FLOWN1.FORT***     **19-07-88**                               C
C                                                                      C
C     THIS IS A FORWARD ICE FLOW MODEL IN ONE DIMENSION. THIS USES THE C
C     DIMENSION SCHEME OF OERLEMANS AND THIS IS WORKING (AS BEST AS I  C
C     KNOW). THIS USES HORIZONTAL AND NORMAL STRESSES.                 C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION H(11),U(11),DIS(11),UNEW(11),DISNEW(11),
     1CHGTHK(11),OLDH(11),D(11),DXX(11),CHGDXX(11),OLDDXX(11),
     2OLDVEL(11),CHGVEL(11)
      PARAMETER (BDOT=9.6D-09,A=5.2D-25,TB=0.1D06,DX=1.0D05,XN=3.0D0,
     1T=.1536D07,RHO=1.D03,G=9.8,DL=1.0D06,SECYR=3.1536D07,
     2B=3.171D-08)
CCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCC
C ZERO ALL VARIABLES C
CCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCC
      DT=T
      NDXX=0
      DXXSAVE=0.0D0
      ITEST=0
      X=0.0D0
      TOL=2.0D0
      DXXTOL=2.0D0
      LIM=0
      SAVE=0.0D0
      CHGMAX=0.0D0
      U(1)=0.0D0
      DO 9 I=1,11
      CHGTHK(I)=0.0D0
      CHGDXX(I)=0.0D0
      U(I)=0.0D0
      H(I)=0.0D0
      DIS(I)=0.0D0
      UNEW(I)=0.0D0
      DISNEW(I)=0.0D0
      OLDH(I)=0.0D0
      D(I)=0.0D0
9     CONTINUE
CCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCC
C SET INITIAL CONDITIONS C
CCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCC
C SET UP INITIAL PROFILE
      DO 10 I=1,11
C      H(I)=DSQRT(2.0D0*TB/(RHO*G)*(DL+2.0D0*DX/10.0D0-X))
      H(I)=3615.0D0*(1.0D0-(X/(DL+2.0D0*DX/10.0D0))**(4.0D0/3.0D0)
     1)**(3.0D0/8.0D0)
      X=X+DX
10    CONTINUE
      BOTTOM=H(11)
C SET UP INITIAL VELOCITIES
      DO 11 I=1,11
      IF(I.EQ.1) THEN
      U(1)=0.0D0
      ELSEIF(I.EQ.11) THEN
      U(I)=2.0D0*A*((-RHO*G*(H(I-2)-4.0D0*H(I-1)+3.0D0*H(I))/
     1(2.0D0*DX))**XN)*(H(11)**(XN+1.0D0))/(XN+2.0D0)
      ELSE
      U(I)=2.0D0*A*((-RHO*G*(H(I+1)-H(I-1))/(2.0D0*DX))**XN)*
     1(H(I)**(XN+1.0D0))/(XN+2.0D0)
      ENDIF
      UNEW(I)=U(I)*SECYR
      DISNEW(I)=U(I)*H(I)*(1.0D0)*SECYR
11    CONTINUE
      DO 12 I=1,11
      IF(I.EQ.1) THEN
      DXX(I)=DABS(U(I+1)/(DX*A))**(1.0D0/3.0D0)
      ELSEIF(I.EQ.11) THEN
      DXX(I)=(DABS(3.0D0*U(I)-4.0D0*U(I-1)+U(I-2))/(2.0D0*DX*A))**(1.0D0
     1/3.0D0)
      ELSE
      DXX(I)=(DABS(U(I+1)-U(I-1))/(2.0D0*DX*A))**(1.0D0/3.0D0)
      ENDIF
12    CONTINUE
CCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCC
C PERFORM ITERATION      C
CCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCC
C---------ITERATION STATEMENT----------------------------------------C
50    IF(TOL.LE.1.0D-03.OR.LIM.GE.1) GOTO 100
      TOL=0.0D0
      NDXX=0
      DXXTOL=2.0D0
      VELTOL=2.0D0
      LIM=LIM+1
C---------COMPUTE VELOCITIES AND NORMAL STRESSES---------------------C
C THE VELOCITIES
16    IF(DXXTOL.GT.1.0D0.AND.VELTOL.GT.1.0D-3) THEN
      VELTOL=0.0D0
      DO 20 I=1,11
      OLDVEL(I)=U(I)
      IF(I.EQ.1) THEN
      U(1)=0.0D0
      ELSEIF(I.EQ.11) THEN
      U(I)=2.0D0*A*((-RHO*G*(H(I-2)-4.0D0*H(I-1)+3.0D0*H(I))/
     1(2.0D0*DX))**XN)*(H(11)**(XN+1.0D0))/(XN+2.0D0)
     2+2.0D0*A*RHO*G*H(I)**2*DXX(I)**2*(H(I-2)-4.0D0*H(I-1)+3.0D0*H(I))/
     3(6.0D0*DX)
      ELSE
      U(I)=2.0D0*A*((-RHO*G*(H(I+1)-H(I-1))/(2.0D0*DX))**XN)*
     1(H(I)**(XN+1.0D0))/(XN+2.0D0)
     2+2.0D0*A*RHO*G*H(I)**2*DXX(I)**2*(H(I+1)-H(I-1))/(6.0D0*DX)
      ENDIF
      CHGVEL(I)=U(I)-OLDVEL(I)
      IF(I.NE.1) THEN
      SAVEVEL=DABS(CHGVEL(I))/OLDVEL(I)
      ENDIF
      IF(SAVEVEL.GT.VELTOL) VELTOL=SAVEVEL
      UNEW(I)=U(I)*SECYR
      DISNEW(I)=U(I)*H(I)*(1.0D0)*SECYR
20    CONTINUE
C THE NORMAL STRESSES
      NDXX=NDXX+1
      DXXTOL=0.0D0
      DO 15 I=1,11
      OLDDXX(I)=DXX(I)
      IF(I.EQ.1) THEN
      DXX(I)=DABS(U(I+1))/(DX*A*DXX(1)**2)
      ELSEIF(I.EQ.11) THEN
      DXX(I)=DABS(3.0D0*U(I)-4.0D0*U(I-1)+U(I-2))/(2.0D0*DX*A*(DXX(I)**2
     1+0.5D0*(-RHO*G*H(I)*(3.0D0*H(I)-4.0D0*H(I-1)+H(I-2))/(2.0D0*DX))**
     22))
      ELSE
      DXX(I)=DABS(U(I+1)-U(I-1))/(2.0D0*DX*A*(DXX(I)**2+0.5D0*(-RHO*G*H(
     1I)*(H(I+1)-H(I-1))/(2.0D0*DX))**2))
      ENDIF
      CHGDXX(I)=DXX(I)-OLDDXX(I)
      DXXSAVE=DABS(CHGDXX(I))
      IF(DXXSAVE.GT.DXXTOL) DXXTOL=DXXSAVE
15    CONTINUE
      GOTO 16
      ENDIF
C---------COMPUTE DIFFUSIVITY----------------------------------------C
      DO 71 I=1,11
      IF(I.EQ.1) THEN
      D(1)=0.0D0
      ELSEIF(I.EQ.11) THEN
      D(11)=(2.0D0*A*(RHO*G)**(XN)*(H(I)**(XN+2.0D0))*(DABS(H(I-2)
     1-4.0D0*H(I-1)+3.0D0*H(I))/(2.0D0*DX))**(XN-1.0D0))/(XN+2.0D0)
      ELSE
      D(I)=(2.0D0*A*(RHO*G)**(XN)*(H(I)**(XN+2.0D0))*(DABS(H(I+1)
     1-H(I-1))/(2.0D0*DX))**(XN-1.0D0))/(XN+2.0D0)
      ENDIF
71    CONTINUE
C---------COMPUTE THICKNESSES----------------------------------------C
      DO 13 I=1,11
      OLDH(I)=H(I)
      SAVE=H(I)
      IF(I.EQ.1) THEN
      H(1)=((D(I+1)+D(I))*(H(I+1)-H(I))/(DX**2)+BDOT)*DT+H(1)
      ELSEIF(I.EQ.11) THEN
      H(11)=BOTTOM
      ELSE
      H(I)=(((D(I+1)+D(I))*(H(I+1)-H(I))-(D(I)+D(I-1))*(H(I)
     1-OLDH(I-1)))/(2.0D0*(DX**2))+BDOT)*DT+H(I)
      ENDIF
      CHGTHK(I)=H(I)-SAVE
      CHGMAX=DABS(H(I)-SAVE)
      IF(TOL.LT.CHGMAX) TOL=CHGMAX
13    CONTINUE
C---------TEST SECTION-----------------------------------------------C
      DO 21 I=1,11
      IF(UNEW(I).LT.0.0D0.OR.UNEW(I).GT.2.0D03) THEN
      ITEST=1
      GOTO 100
      ELSEIF(I.NE.11.AND.(H(I)-H(I+1)).LT.0.0D0) THEN
      ITEST=2
      GOTO 100
      ELSE
      CONTINUE
      ENDIF
21    CONTINUE
      GOTO 50
100   CONTINUE
CCCCCCCCCCCCCCCCCCCCCCCCCC
C WRITE THE OUTPUT       C
CCCCCCCCCCCCCCCCCCCCCCCCCC
C CONVERT VELOCITIES AND DISCHARGE TO M/S
C AND M**3/S TO M/A AND M**3/A
C AND WRITE THE OUTPUT
      DO 14 I=1,11
      WRITE(6,901) I,H(I),UNEW(I),DISNEW(I),CHGTHK(I)
901   FORMAT(' ','I=',I3,3X,'H=',D15.7,5X,'U=',D15.7,5X,
     1'DISCHARGE=',D15.7,5X,'DELTHK=',D15.7)
      WRITE(6,903) D(I),DXX(I)
903   FORMAT(' ',5X,'D=',D15.7,5X,'DXX(I)=',D15.7)
14    CONTINUE
      WRITE(6,905) NDXX
905   FORMAT(' ','THE NDXX=',I5)
      WRITE(6,902) LIM
902   FORMAT(' ','THE NUMBER OF ITERATIONS =',I8)
      WRITE(6,904) ITEST
904   FORMAT(' ','ITEST=',I3)
      STOP
      END
//GO.SYSIN  DD  *
/*
//
